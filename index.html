<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ChatGPT Widget Test</title>
    <style>
      body { font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 24px; max-width: 680px; margin: auto; }
      textarea, input, button { width: 100%; padding: 12px; margin: 8px 0; }
      button { cursor: pointer; }
      .reply { white-space: pre-wrap; border: 1px solid #ddd; padding: 12px; border-radius: 8px; }
    </style>
  </head>
  <body>
    <h1>ChatGPT Widget Test</h1>
    <textarea id="prompt" rows="4" placeholder="Ask something…">Give me 3 quick tips for recovering from ACL surgery.</textarea>
    <button id="send">Send</button>
    <div id="out" class="reply"></div>

    <script>
      const btn = document.getElementById('send');
      const out = document.getElementById('out');
      btn.onclick = async () => {
        out.textContent = 'Thinking…';
        const prompt = document.getElementById('prompt').value;
        try {
          const res = await fetch('/api/chatgpt', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ prompt })
          });
          const data = await res.json();
          out.textContent = data.reply || JSON.stringify(data, null, 2);
        } catch (e) {
          out.textContent = 'Error: ' + e.message;
        }
      };
    </script>
  </body>
</html>
